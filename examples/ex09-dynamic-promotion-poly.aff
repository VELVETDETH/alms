(* Polymorphic version: A Dynamic Promotion Intervenes (like ex7.aff) *)

let[C] ap : all 'a. ('a -> 'a) -> 'a -> 'a =
  \'a.
    \f: 'a -> 'a.
      \x: 'a.
        f x

let[A] inc : int -> int =
  \y: int.
    (\g: int -o int.
       (ap[int] :  (int -> int) -> int -> int
                :> (int -o int) -> int -o int) g y)
    (\z: int. z + 1)

in print[int] (inc 5)
