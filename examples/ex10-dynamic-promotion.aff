(* A Lying Dynamic Promotion (like ex8.aff -- blame inc) *)

module[C] ap : (int -> int) -> int -> int =
  \f: int -> int.
    \x: int.
      f (f x)    (* f is used twice here, despite what iap2 claims *)

module[A] inc : int -> int =
  \y: int.
    (\g: int -o int.
       (ap : (int -> int) -> int -> int
           :> (int -o int) -> int -o int) g y)
    (\z: int. add z 1)

in printInt (inc 5)
